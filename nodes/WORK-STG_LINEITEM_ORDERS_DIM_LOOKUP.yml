fileVersion: 1
id: 0f470c2d-57b5-4051-989e-8ad736b68889
name: STG_LINEITEM_ORDERS_DIM_LOOKUP
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: WORK
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 568aa414-2f21-475d-8e0b-2ac5784539bd
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_CUSTOMER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deb27834-1ca2-45c5-86ce-c4ffc033c059
                stepCounter: e25c1c04-3320-4184-9907-65c040f13950
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22815608-dd1c-48ed-859f-56dbd413d550
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_PART_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fa68955-c12d-42e5-818b-08c47341d887
                stepCounter: 7452d3a7-e5b8-46af-981b-c6d28e5e6c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41fbf259-aff9-43a9-9cda-5f9d54dedbfa
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1e3c2b4-41ff-491b-8c48-348797d2d607
                stepCounter: a9a30bb7-5540-41b0-9267-1277d4424d34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a4507cd-1ed0-476c-a159-685839cbd40a
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99a35793-948a-4616-a968-2cd6733f4acc
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23b0f202-7910-462d-b576-a4b0a4b94704
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48b3b095-98db-4f51-8706-1d459234edce
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccc5ad34-f7d4-4b3c-96e1-f23e73c9a0f2
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_PARTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 800210fc-f63f-480d-bc89-f11b791e9d50
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28787136-5cf8-4ed6-8653-cc748ace2216
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2feae5e0-68ef-4450-91ae-87a1dc1d1c81
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9582c4ee-b4e8-4f8c-8717-82a488d9bff6
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00887371-770e-417c-8076-1e6de83e89a2
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83301073-0a76-47d0-9c57-c73756430d92
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ed8e942-15d9-472a-9ce3-524fb9ce5f00
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b911614-d28c-42c1-82d8-12945381132f
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3545e28c-74d5-4576-9fbb-a6a0057407d6
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5d727c2-37de-40d4-9dc3-6782ca1509f2
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab44cd86-d8d4-4020-9df1-4219c71ca566
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2561065-0a79-4f02-b645-947bdd1e18c7
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6365dbb4-1caa-480a-9e4d-9beaeedf4a03
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c5b8f03-d6fc-49af-a857-50cfc1b6247a
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f85a194b-313e-4ade-b455-8fdad5ee896c
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c19bcb7-8807-43a2-a667-45856736f4e3
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07a85899-911c-4f3a-aeb2-ec0f5e8874be
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f542ac2e-076a-4bb5-9084-c37d0a84a880
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8b80506-8217-4487-8dea-6f9b1ad02a4e
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37b11ca3-642b-4516-bfb3-162c1c985dc4
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ec4a0c-67e0-466c-884b-05ccf6ef0a91
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35aebd5a-88cd-4ab3-bbac-16f88e511b92
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1270374c-a57b-4f0a-ab83-7d0201b8078b
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 079d1590-45fc-4c7c-8998-79f5ce741596
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56b2eda4-c17c-4c76-92ab-d2abccefd749
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b143f4ca-ce2f-43be-a2b3-f6e3952281b9
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30ab46c0-449b-43ad-8b49-20b3216fd42e
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4436a615-22e4-4472-b4a5-f4fdd4e3c836
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e53e61d8-bcd7-42de-af9b-cbabbdbd51c0
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08300f0d-0832-4324-8b58-dbccf1085e75
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88f3db21-19a8-401b-9bc6-25197c063b6c
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7b0f558-2596-4df7-be17-aeb59d2f80cd
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 462c83cf-7e61-4979-b8c0-e8bdda63ed71
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8884241d-a594-4db1-9263-07d82389ccc4
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2a79b88-eb17-4ba0-9e94-40ec88667fa4
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f65f0f2-670a-48fd-b586-c0de1c9bf84e
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07274515-7f8c-41b4-a041-294aafd3cedf
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 842c0563-83a1-4e8d-9733-93616090f09a
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03c9e48e-c699-41be-9b8d-032c06bcedc5
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a0e5be3-9260-4711-8943-2998e03247b7
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: DATE
        description: ""
        name: L_RECEIPTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e4befdb-ab9f-4fd6-bf79-874d2ef6eb4f
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07f3bd59-cb48-4ceb-96a9-43e4bb1d7266
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8d89b48-5f0d-48a4-b04f-10f65171f3d6
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 151364b2-8bf6-4070-92b1-259b01ad8d9a
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f95efb74-067c-4991-bb65-67f42254e074
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb128b05-90ba-4005-ac5e-76b48b1c11ba
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54ce5807-912d-49f2-8454-76ae2e6ef7ea
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89ee089d-a11b-4a04-8b38-d5db300a6dd2
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER
        description: ""
        name: DAYS TO SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a311670-c2e1-4d66-931b-529657fccf35
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e847911b-6b0f-4af7-bc20-569e85845315
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PS_AVAILQTY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b6d3011-4864-4110-bc10-3e17ac46bbc8
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 25189134-66a5-4819-8ea5-4a4e7bb6877d
          stepCounter: 0f470c2d-57b5-4051-989e-8ad736b68889
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: PS_SUPPLYCOST
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17f975a7-7cd6-4ed9-b649-a8af667d5535
                stepCounter: 511213b8-e13f-4159-b8c6-6133b30a907d
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_CUSTOMER: e25c1c04-3320-4184-9907-65c040f13950
          DIM_PART: 7452d3a7-e5b8-46af-981b-c6d28e5e6c84
          DIM_SUPPLIER: a9a30bb7-5540-41b0-9267-1277d4424d34
          STG_ORDERS_LINEITEM: 511213b8-e13f-4159-b8c6-6133b30a907d
          STG_PARTSUPP: 9c2caa20-e97f-48d6-80c2-52e01c5e0888
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: DIM_CUSTOMER
          - locationName: WORK
            nodeName: DIM_PART
          - locationName: WORK
            nodeName: DIM_SUPPLIER
          - locationName: WORK
            nodeName: STG_ORDERS_LINEITEM
          - locationName: WORK
            nodeName: STG_PARTSUPP
        join:
          joinCondition: |-
            FROM {{ ref('WORK', 'STG_ORDERS_LINEITEM') }} "STG_ORDERS_LINEITEM"
            LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
            ON "STG_ORDERS_LINEITEM"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
            AND "STG_ORDERS_LINEITEM"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
            /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
            LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
            ON "STG_ORDERS_LINEITEM"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
            LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
            ON "STG_ORDERS_LINEITEM"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
            LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
            ON "STG_ORDERS_LINEITEM"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
            "STG_ORDERS_LINEITEM"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
        name: STG_LINEITEM_ORDERS_DIM_LOOKUP
        noLinkRefs: []
  name: STG_LINEITEM_ORDERS_DIM_LOOKUP
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
